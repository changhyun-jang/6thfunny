<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/css/ggart.css" />
    <link rel="stylesheet" href="/css/seat_review.css" />
    <link rel="stylesheet" href="css/review_popup.css" />
    <style>
      .selected {
        /* 선택된 좌석에 대한 스타일 */
        background-color: blue; /* 예제에서는 파란색으로 표시 */
      }

      .reviewed {
        /* 리뷰 등록된 좌석에 대한 스타일 */
        background-color: green; /* 예제에서는 초록색으로 표시 */
      }

      /* 모달창 스타일 */
      .modal,
      .reviewModal {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: white;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        z-index: 9999;
      }

      .reviewModal {
        display: none;
      }
    </style>
    <script>
      // 팝업 창을 열기 위한 함수
      function openPopup() {
        // 팝업 창의 URL (이전에 보여준 HTML 파일의 경로) 설정
        var popupURL = "1.html";

        // 팝업 창의 크기 설정
        var popupWidth = 490;
        var popupHeight = 600;

        // 팝업 창을 가운데에 위치시키기 위한 좌표 계산
        var leftPosition = (screen.width - popupWidth) / 2;
        var topPosition = (screen.height - popupHeight) / 2;

        // 팝업 창 열기
        window.open(
          popupURL,
          "후기 작성하기", // 팝업 창의 이름
          "width=" +
            popupWidth +
            ", height=" +
            popupHeight +
            ", left=" +
            leftPosition +
            ", top=" +
            topPosition
        );
      }
    </script>
    <title>연습2</title>
  </head>
  <body>
    <!-- 헤더의 메뉴 -->
    <header>
      <div class="menuBar">
        <span>찾아보기</span>
        <span>작성하기</span>
        <button class="sign">로그인</button>
      </div>
    </header>
    <!-- 선택한 공연장 상세 정보 -->
    <h2>공연장 정보</h2>
    <section class="infoSection">
      <div class="infoLeft">
        <img src="/img/ggartcenter.jpg" alt="경기아트센터" width="410px" />
      </div>
      <div class="infoRight">
        <table class="centerInfo">
          <tr>
            <th>공연장명</th>
            <td>경기아트센터 - 소극장</td>
          </tr>
          <tr>
            <th>주소안내</th>
            <td>
              경기도 수원시 팔달구 효원로 307번길 20(인계동) 경기아트센터 (우
              16488)
            </td>
          </tr>
          <tr>
            <th>홈페이지</th>
            <td><a href="http://www.ggac.or.kr/">http://www.ggac.or.kr/</a></td>
          </tr>
          <tr>
            <th>전화번호</th>
            <td><a href="tel:031-230-3200">031-230-3200</a></td>
          </tr>
          <tr>
            <th>좌석안내</th>
            <td>502석 (1층 301석, 2층 195석, 장애인석 6석)</td>
          </tr>
          <tr>
            <th>주차안내</th>
            <td>유료 주차장 보유 / 관람객 할인 적용</td>
          </tr>
          <tr>
            <th>편의시설</th>
            <td>장애인 이용 시설, 유아 시설, 카페 마련</td>
          </tr>
        </table>
      </div>
    </section>
    <!-- 좌석 후기 안내 -->
    <h2>좌석 후기 찾아보기</h2>
    <section class="reviewSection">
      <p class="reviewP">
        <strong>TIP!</strong> 주황색 좌석을 누르면 이용객의
        <strong>생생한 후기</strong>를 확인할 수 있어요👀
        <button class="reviewBu" onclick="openPopup()">후기 작성하기✍</button>
      </p>
    </section>
    <!-- 좌석 배치도 부분 시작 -->
    <div class="seatLayout">
      <div class="test">
        <div class="stage">무대</div>
        <div class="column" style="top: 65px; left: 220px">
          <strong>A</strong>
        </div>
        <div class="column" style="top: 65px; left: 505px">
          <strong>B</strong>
        </div>
        <div class="column" style="top: 65px; left: 799px">
          <strong>C</strong>
        </div>
        <!-- A구역 1열 -->
        <div
          class="seat"
          data-seat-id="A1"
          style="top: 90px; left: 201px"
        ></div>
        <div
          class="seat"
          data-seat-id="A2"
          style="top: 90px; left: 212px"
        ></div>
        <div class="seat" style="top: 90px; left: 223px"></div>
        <div class="seat" style="top: 90px; left: 234px"></div>
        <div class="seat" style="top: 90px; left: 245px"></div>
        <!-- B구역 1열 -->
        <div class="seat" style="top: 90px; left: 445px"></div>
        <div class="seat" style="top: 90px; left: 456px"></div>
        <div class="seat" style="top: 90px; left: 467px"></div>
        <div class="seat" style="top: 90px; left: 478px"></div>
        <div class="seat" style="top: 90px; left: 489px"></div>
        <div
          class="seat"
          style="top: 90px; left: 500px"
          title="B구역 1열 6번"
        ></div>
        <div
          class="seat"
          style="top: 90px; left: 511px; background-color: orange"
          title="B구역 1열 7번: 1건"
        ></div>
        <div class="seat" style="top: 90px; left: 522px"></div>
        <div class="seat" style="top: 90px; left: 533px"></div>
        <div class="seat" style="top: 90px; left: 544px"></div>
        <div class="seat" style="top: 90px; left: 555px"></div>
        <div class="seat" style="top: 90px; left: 566px"></div>
        <div class="seat" style="top: 90px; left: 577px"></div>
        <!-- C구역 1열 -->
        <div class="seat" style="top: 90px; left: 777px"></div>
        <div class="seat" style="top: 90px; left: 788px"></div>
        <div class="seat" style="top: 90px; left: 799px"></div>
        <div class="seat" style="top: 90px; left: 810px"></div>
        <div class="seat" style="top: 90px; left: 821px"></div>

        <!-- A구역 2열 -->
        <div class="seat" style="top: 105px; left: 190px"></div>
        <div class="seat" style="top: 105px; left: 201px"></div>
        <div class="seat" style="top: 105px; left: 212px"></div>
        <div class="seat" style="top: 105px; left: 223px"></div>
        <div class="seat" style="top: 105px; left: 234px"></div>
        <div class="seat" style="top: 105px; left: 245px"></div>
        <!-- B구역 2열 -->
        <div class="seat" style="top: 105px; left: 434px"></div>
        <div class="seat" style="top: 105px; left: 445px"></div>
        <div class="seat" style="top: 105px; left: 456px"></div>
        <div class="seat" style="top: 105px; left: 467px"></div>
        <div class="seat" style="top: 105px; left: 478px"></div>
        <div class="seat" style="top: 105px; left: 489px"></div>
        <div class="seat" style="top: 105px; left: 500px"></div>
        <div class="seat" style="top: 105px; left: 511px"></div>
        <div class="seat" style="top: 105px; left: 522px"></div>
        <div class="seat" style="top: 105px; left: 533px"></div>
        <div class="seat" style="top: 105px; left: 544px"></div>
        <div class="seat" style="top: 105px; left: 555px"></div>
        <div class="seat" style="top: 105px; left: 566px"></div>
        <div class="seat" style="top: 105px; left: 577px"></div>
        <!-- C구역 2열 -->
        <div class="seat" style="top: 105px; left: 777px"></div>
        <div class="seat" style="top: 105px; left: 788px"></div>
        <div class="seat" style="top: 105px; left: 799px"></div>
        <div class="seat" style="top: 105px; left: 810px"></div>
        <div class="seat" style="top: 105px; left: 821px"></div>
        <div class="seat" style="top: 105px; left: 832px"></div>
      </div>
      <!-- 리뷰를 등록할 수 있는 모달창 -->
      <div class="modal" style="display: none">
        <h3>리뷰 등록</h3>
        <textarea id="reviewInput" placeholder="리뷰를 작성해주세요"></textarea>
        <button onclick="submitReview()">등록</button>
        <button onclick="closeModal()">취소</button>
      </div>

      <!-- 리뷰를 보여주는 모달창 -->
      <div class="reviewModal" style="display: none">
        <h3>리뷰</h3>
        <p id="reviewContent"></p>
        <button onclick="closeReviewModal()">닫기</button>
      </div>
    </div>
    <footer class="footer"></footer>
    <script>
      // 객체를 복사하는 함수
      function copyObject(obj) {
        return Object.assign({}, obj); // 또는 return { ...obj };
      }
      // 모달창 열기
      function openModal(index) {
        const seatId = seatData[index].id;
        const seat = document.getElementById(seatId);

        if (seat) {
          const modal = document.querySelector(".modal");
          modal.style.display = "block";

          const reviewInput = document.getElementById("reviewInput");
          reviewInput.value = seatData[index].review;

          // 리뷰 등록 후 선택된 좌석을 초록색으로 변경
          seat.classList.remove("selected");
          seat.classList.add("reviewed");
        }
      }

      // 모달창 닫기
      function closeModal() {
        const modal = document.querySelector(".modal");
        modal.style.display = "none";
      }

      // 리뷰 등록
      function submitReview() {
        const reviewInput = document.getElementById("reviewInput");
        const review = reviewInput.value;

        const selectedSeats = document.querySelectorAll(".seat.selected");
        selectedSeats.forEach((seat) => {
          const seatId = seat.getAttribute("data-seat-id");
          const seatIndex = seatData.findIndex((data) => data.id === seatId);

          const newSeatData = copyObject(seatData[seatIndex]); // 새로운 객체 생성
          newSeatData.review = review;

          // 등록된 리뷰가 있으면 좌석을 초록색으로 표시
          if (review) {
            newSeatData.color = "green"; // 초록색으로 변경 (원하는 색상으로 수정 가능)
          } else {
            newSeatData.color = ""; // 리뷰가 없으면 색상 제거
          }

          seatData[seatIndex] = newSeatData; // 기존 배열의 객체를 새로운 객체로 교체
          seat.classList.remove("selected");
        });

        closeModal();
      }

      // 리뷰 보기 모달창 열기
      function openReviewModal(index) {
        const reviewModal = document.querySelector(".reviewModal");
        reviewModal.style.display = "block";

        const reviewContent = document.getElementById("reviewContent");
        reviewContent.textContent = seatData[index].review;
      }

      // 리뷰 보기 모달창 닫기
      function closeReviewModal() {
        const reviewModal = document.querySelector(".reviewModal");
        reviewModal.style.display = "none";
      }

      // 좌석 정보와 리뷰 데이터를 저장할 배열
      const seatData = [
        {
          id: "A1", // 좌석 식별자
          review: "", // 리뷰 데이터 (초기 값은 빈 문자열)
          color: "", // 좌석 색깔 (리뷰 등록 시 변경될 예정)
        },
        {
          id: "A2",
          review: "",
          color: "",
        },
        // ... 추가 좌석 정보 ...
      ];
      // 좌석 요소들을 선택하고 클릭 이벤트 리스너를 추가합니다
      const seats = document.querySelectorAll(".seat");
      seats.forEach((seat) => {
        seat.addEventListener("click", () => {
          const seatId = seat.dataset.seatId; // data-seat-id 속성 값을 가져옴
          const seatIndex = seatData.findIndex((data) => data.id === seatId);

          if (seatIndex !== -1) {
            // 좌석이 선택되지 않은 경우, 선택 모달창 표시
            openModal(seatIndex);
          } else {
            // 해당 좌석 정보가 없는 경우 예외 처리
            console.error("해당 좌석 정보를 찾을 수 없습니다.");
          }
        });
      });
    </script>
  </body>
  <script src="./js/cookieCheck.js"></script>
</html>
